#!/usr/bin/env node

'use strict'
const { validateTokenMaxAge, validateTokenPermissions } = require('../src/index.js');
const { parsePolicyFromArgv } = require('../src/helpers');

const policy = parsePolicyFromArgv(process.argv);

const validAges = validateTokenMaxAge(policy);
const validPerms = validateTokenPermissions(policy);
process.exitCode = validAges && validPerms ? 0 : 1;

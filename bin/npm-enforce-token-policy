#!/usr/bin/env node

'use strict'
const {enforceMaxNPMTokenAge, enforceNPMTokenPermissions} = require('../src/index.js');

const policy = {
  maxAgeInDays: 30,
  allowPublishTokens: false,
  allowAutomationTokens: false
};

let numArg;
while (process.argv[2]) {
  switch (process.argv[2]) {
    case '--max-age':
      numArg = Number(process.argv[3]);
      if (process.argv[3] && numArg) {
        policy.maxAgeInDays = numArg;
        process.argv.shift();
      }
      break;
    case '--allow-publish-tokens':
      policy.allowPublishTokens = true;
      break;
    case '--allow-automation-tokens':
      policy.allowAutomationTokens = true;
      break;
  }
  process.argv.shift();
}

enforceMaxNPMTokenAge(policy);
enforceNPMTokenPermissions(policy);
